# 預約試躺功能 UX 優化重構 PRD

**文件版本**: 1.0  
**創建日期**: 2025-12-01  
**更新日期**: 2025-12-01  
**文檔狀態**: 草稿  
**負責人**: UX 團隊

---

## 📋 項目概述

### 項目名稱
**預約試躺功能 UX 優化重構**

### 項目目標
通過系統性重構預約流程，提升用戶體驗、增加完成率、減少流失率，並建立可擴展的預約系統架構。

### 項目背景
基於用戶行為分析和 UX 審查，現有預約試躺功能存在多個嚴重的用戶體驗問題，影響轉換率和用戶滿意度。需要進行全面重構以符合現代 UX 最佳實踐。

### 項目範圍
- 預約流程所有步驟的 UX 重構
- 響應式設計優化
- 無障礙性改進
- 錯誤處理機制完善
- 狀態管理系統優化
- **移除 Magic Link，改用現有會員登入/註冊機制**
- **嚴格重用現有組件，禁止創建新的認證流程**
- **LINE 通知集成 (Phase 2)**
- **用戶自助管理預約 (Phase 2)**

---

## 🎯 問題陳述

### 現有問題分析

#### 🚨 關鍵問題
1. **用戶控制權喪失**
   - 自動跳轉功能移除用戶主導權
   - 用戶無法重新考慮選擇
   - 造成用戶焦慮和困惑

2. **交互模式不一致**
   - 混用自動、點擊、鍵盤多種導航方式
   - 用戶體驗不可預測
   - 學習成本增加

3. **認證流程設計缺陷**
   - 過早要求用戶認證
   - 缺乏清晰說明和價值傳達
   - 造成流程中斷感

#### ⚠️ 重要問題
4. **表單驗證體驗不佳**
   - 驗證消息不準確
   - 缺乏即時反饋
   - 錯誤恢復機制不足

5. **移動端體驗欠佳**
   - 響應式設計不完整
   - 觸控目標尺寸不當
   - 佈局在小屏幕設備上表現不佳

### 業務影響
- 預約完成率低於行業標準
- 用戶流失率高
- 客服諮詢量增加
- 品牌體驗受損

---

## 💡 解決方案設計

### 設計原則

#### 1. **用戶控制優先**
- 移除所有自動跳轉功能
- 提供明確的導航控制
- 支持用戶自主決策

#### 2. **一致性體驗**
- 統一交互模式和視覺語言
- 標準化的按鈕和狀態設計
- 一致的錯誤處理機制

#### 3. **漸進式披露**
- 信息按需展示
- 逐步引導用戶完成流程
- 減少認知負擔

#### 4. **移動優先設計**
- 優先考慮移動端體驗
- 觸控友好的界面設計
- 適配各種屏幕尺寸

### 核心解決方案

#### 重構後的流程架構
```
步驟 1: 門市選擇 → 詳細資訊展示 + 明確繼續按鈕
步驟 2: 產品選擇 → 豐富產品資訊 + 比較功能
步驟 3: 個人資訊 → 即時驗證 + 錯誤恢復
步驟 4: 預約時間 → 直觀日曆 + 可用性指示
步驟 5: 確認提交 → 可編輯摘要 + 最終確認
```

#### 新增功能特性
1. **智能進度指示器**
   - 顯示當前步驟和剩餘步驟
   - 標記已完成步驟
   - 提供步驟間快速導航

2. **即時表單驗證**
   - 輸入時即時驗證
   - 清晰的錯誤提示
   - 自動聚焦到錯誤欄位

3. **響應式卡片設計**
   - 移動端單欄佈局
   - 平板雙欄優化
   - 桌面多欄展示

4. **錯誤恢復機制**
   - 網絡錯誤自動重試
   - 表單數據自動保存
   - 錯誤狀態優雅降級

---

## 📝 功能需求

### 核心功能

#### FR-001: 移除自動跳轉機制
**描述**: 移除所有自動步驟切換功能  
**詳情**:
- 移除 `setTimeout(nextStep(), 300)` 調用
- 添加「繼續」按鈕到每個選擇步驟
- 按鈕需要滿足選擇條件才啟用
- 提供明確的用戶反饋

**驗收標準**:
- [ ] 用戶必須手動點擊按鈕才能進入下一步
- [ ] 按鈕狀態正確反映選擇完成狀態
- [ ] 無任何自動跳轉行為存在

#### FR-002: 統一交互模式
**描述**: 標準化所有步驟的交互模式  
**詳情**:
- 統一的「上一步」/「繼續」按鈕設計
- 一致的鍵盤導航支援
- 標準化的焦點管理
- 統一的視覺反饋效果

**驗收標準**:
- [ ] 所有步驟使用相同按鈕配置
- [ ] Tab 鍵導航按邏輯順序移動
- [ ] Enter 鍵執行當前操作
- [ ] 視覺反饋保持一致

#### FR-003: 延遲認證策略
**描述**: 將認證流程延遲到最終提交階段  
**詳情**:
- 前四個步驟允許匿名訪問
- 在審核步驟要求認證
- **使用現有會員登入/註冊表單 (Modal 形式)**
- **直接集成現有 `better-auth` 客戶端，不創建新流程**
- **最大化重用現有 UI 組件 (如 Button, Input)**
- 支持認證後直接提交

### FR-004: LINE 通知集成 (Phase 2)
- **目標**: 確保管理員即時獲知新預約及變更。
- **觸發時機**:
    - 新預約建立時 -> 通知 Admin (LINE@)
    - 用戶取消/修改預約時 -> 通知 Admin (LINE@)
- **技術**: 使用 LINE Messaging API (Push Message)。

### FR-005: 用戶自助管理 (Phase 2)
- **目標**: 讓用戶能查看並管理自己的預約。
- **功能**:
    - 查看預約列表 (My Appointments)
    - 取消預約
- **UI**: 在用戶個人資料頁面增加「我的預約」區塊。

**驗收標準**:
- [ ] 前四步驟無認證要求
- [ ] 認證後直接返回審核步驟
- [ ] 認證價值說明清晰可見
- [ ] 用戶可以選擇稍後認證

#### FR-004: 即時表單驗證
**描述**: 實施即時的表單驗證和錯誤處理  
**詳情**:
- 輸入時即時驗證
- 清晰的錯誤消息
- 自動保存表單數據
- 錯誤恢復機制

**驗收標準**:
- [ ] 每個欄位都有即時驗證
- [ ] 錯誤消息準確且有用
- [ ] 頁面刷新後恢復輸入數據
- [ ] 網絡錯誤有自動重試

#### FR-005: 移動優先響應式設計
**描述**: 實施全面的移動端優化  
**詳情**:
- 手機單欄佈局
- 觸控目標最小 44px
- 優化的字體大小
- 簡化的導航結構

**驗收標準**:
- [ ] 在 320px-768px 設備完美顯示
- [ ] 所有可點擊元素 ≥ 44px
- [ ] 字體大小 ≥ 16px
- [ ] 導航清晰易用

### 增強功能

#### ER-001: 進度指示器增強
**描述**: 豐富進度指示器的信息和功能  
**詳情**:
- 步驟標題和描述
- 完成狀態標記
- 步驟間快速跳轉
- 進度百分比顯示

#### ER-002: 產品比較功能
**描述**: 允許用戶比較不同產品  
**詳情**:
- 產品特性對比表
- 差異高亮顯示
- 收藏功能
- 分享比較結果

#### ER-003: 日曆集成優化
**描述**: 改進時間選擇體驗  
**詳情**:
- 視覺化日曆界面
- 可用時間段高亮
- 已預約時間禁用
- 智能時間建議

#### ER-004: 確認郵件增強
**描述**: 改善預約確認流程  
**詳情**:
- 精美的確認郵件設計
- 可編輯的預約詳情
- 日曆事件邀請
- 一鍵重新安排功能

---

## 👥 用戶故事

### 主要用戶故事

#### US-001: 謹慎選擇的用戶
**作為** 一個謹慎的用戶  
**我想要** 在每個選擇步驟有足夠時間考慮  
**以便於** 做出最適合我的決定

**驗收場景**:
```
Given: 我在門市選擇頁面
When: 我點擊了一個門市但沒有立即跳轉
Then: 系統顯示「繼續選擇產品」按鈕
And: 我可以仔細查看門市信息後再決定
```

#### US-002: 移動端用戶
**作為** 一個主要使用手機的用戶  
**我想要** 在手機上有良好的預約體驗  
**以便於** 隨時隨地完成預約

**驗收場景**:
```
Given: 我在手機上打開預約頁面
When: 我瀏覽各個步驟
Then: 界面完美適配手機屏幕
And: 所有按鈕都很容易點擊
And: 文字清晰可讀
```

#### US-003: 習慣鍵盤導航的用戶
**作為** 一個習慣鍵盤操作的用戶  
**我想要** 完全通過鍵盤完成預約  
**以便於** 提高操作效率

**驗收場景**:
```
Given: 我在預約頁面
When: 我使用 Tab 鍵導航
Then: 焦點按邏輯順序移動
And: Enter 鍵執行當前操作
And: 所有功能都可以鍵盤操作
```

#### US-004: 中間退出重新進入的用戶
**作為** 一個可能中途退出的用戶  
**我想要** 重新進入時恢復之前的進度  
**以便於** 不用重新填寫信息

**驗收場景**:
```
Given: 我填寫了部分信息後關閉頁面
When: 我重新打開預約頁面
Then: 之前的選擇和填寫的信息都還在
And: 我可以從斷掉的地方繼續
```

### 次要用戶故事

#### US-005: 視覺障礙用戶
**作為** 一個視覺障礙的用戶  
**我想要** 通過屏幕閱讀器正常使用預約功能  
**以便於** 無障礙地完成預約

#### US-006: 網絡不穩定環境下的用戶
**作為** 一個網絡不穩定環境的用戶  
**我想要** 在網絡恢復後繼續預約流程  
**以便於** 避免重新填寫信息

---

## ✅ 驗收標準

### 功能驗收標準

#### A-001: 用戶控制權
- [ ] 移除所有自動跳轉功能
- [ ] 每個步驟都有明確的「繼續」按鈕
- [ ] 按鈕啟用狀態正確反映選擇完成情況
- [ ] 用戶可以隨時返回上一步

#### A-002: 交互一致性
- [ ] 所有步驟使用統一的按鈕設計
- [ ] 鍵盤導航邏輯一致
- [ ] 視覺反饋效果統一
- [ ] 錯誤處理方式一致

#### A-003: 認證流程
- [ ] 前四個步驟無認證要求
- [ ] 第五步驟要求認證並說明原因
- [ ] 認證後自動返回流程
- [ ] 提供稍後認證選項

#### A-004: 表單驗證
- [ ] 所有欄位實施即時驗證
- [ ] 錯誤消息準確且有用
- [ ] 表單數據自動保存
- [ ] 錯誤欄位自動聚焦

#### A-005: 響應式設計
- [ ] 移動端 (320px-768px) 完美顯示
- [ ] 平板端 (768px-1024px) 優化顯示
- [ ] 桌面端 (1024px+) 完整功能
- [ ] 所有觸控目標 ≥ 44px

### 性能驗收標準

#### P-001: 頁面載入性能
- [ ] 首頁載入時間 < 2 秒
- [ ] 步驟切換動畫 < 300ms
- [ ] 表單驗證響應 < 100ms
- [ ] 圖片載入優化 (懶載入)

#### P-002: 交互響應性
- [ ] 按鈕點擊響應 < 50ms
- [ ] 鍵盤導航響應 < 50ms
- [ ] 表單輸入響應 < 100ms
- [ ] 錯誤提示顯示 < 200ms

### 可用性驗收標準

#### U-001: 任務完成率
- [ ] 完整流程完成率 > 95%
- [ ] 各步驟完成率 > 98%
- [ ] 錯誤恢復成功率 > 90%
- [ ] 中間退出率 < 5%

#### U-002: 用戶滿意度
- [ ] 用戶滿意度 > 4.5/5
- [ ] 易用性評分 > 4.5/5
- [ ] 推薦意願 > 85%
- [ ] 重新預約意願 > 80%

---

## 🔧 技術需求

### 前端技術需求

#### T-001: React 組件重構
**技術要求**:
- TypeScript 開發
- React 18+ 功能使用
- Hooks 狀態管理
- 組件化設計模式

**實施詳情**:
```typescript
// 新的步驟組件架構
interface StepProps {
  data: StepData;
  onNext: () => void;
  onPrevious: () => void;
  canProceed: boolean;
  isLoading: boolean;
}

const StepComponent: React.FC<StepProps> = ({
  data,
  onNext,
  onPrevious,
  canProceed,
  isLoading
}) => {
  // 組件實現
};
```

#### T-002: 狀態管理優化
**技術要求**:
- Zustand 狀態管理
- 持久化存儲支持
- 錯誤狀態處理
- 載入狀態管理

**實施詳情**:
```typescript
// 優化的狀態管理
interface AppointmentState {
  currentStep: number;
  formData: FormData;
  validationErrors: ValidationErrors;
  isLoading: boolean;
  canProceed: boolean;
  
  actions: {
    updateFormData: (data: Partial<FormData>) => void;
    validateStep: () => boolean;
    nextStep: () => void;
    previousStep: () => void;
  };
}
```

#### T-003: 響應式 CSS 架構
**技術要求**:
- Tailwind CSS
- 移動優先設計
- 組件化樣式
- 主題變量支持

**實施詳情**:
```css
/* 響應式卡片組件 */
.appointment-card {
  @apply p-6 rounded-lg border-2 transition-all duration-200;
  
  /* 移動端 */
  @apply text-sm;
  
  /* 平板 */
  @apply md:text-base md:p-8;
  
  /* 桌面 */
  @apply lg:text-lg;
  
  /* 懸停狀態 */
  @apply hover:border-black hover:shadow-lg focus:outline-none focus:border-black;
}
```

### 無障礙性技術需求

#### A-001: ARIA 標籤支持
- 所有互動元素都有適當的 ARIA 標籤
- 進度指示器使用 role="progressbar"
- 錯誤消息使用 aria-live 屬性
- 表單標籤與輸入框正確關聯

#### A-002: 鍵盤導航支持
- Tab 順序邏輯清晰
- Enter 鍵觸發預期操作
- Escape 鍵關閉模態框
- 焦點管理機制完善

#### A-003: 屏幕閱讀器支持
- 語義化 HTML 標籤
- 圖片和圖標有替代文本
- 動態內容更新有適當通知
- 表單驗證錯誤清晰描述

### 後端技術需求

#### B-001: API 優化
- RESTful API 設計
- 錯誤處理標準化
- 請求驗證機制
- 速率限制實施

#### B-002: 數據持久化
- 表單數據自動保存
- 會話狀態管理
- 數據一致性保證
- 安全數據存儲

---

## 📊 成功指標

### 關鍵績效指標 (KPI)

#### 轉換率指標
- **預約完成率**: 從當前 <80% 提升至 >95%
- **各步驟完成率**: 平均 >98%
- **中途退出率**: 從當前 >20% 降至 <5%
- **認證完成率**: >90%

#### 用戶體驗指標
- **任務完成時間**: 平均 <5 分鐘
- **用戶滿意度**: >4.5/5
- **錯誤恢復率**: >90%
- **再次預約意願**: >80%

#### 技術性能指標
- **頁面載入時間**: <2 秒
- **交互響應時間**: <100ms
- **移動端體驗分數**: >95%
- **無障礙性分數**: AA 級別

### 監控指標

#### 用戶行為分析
- 步驟完成時間分布
- 錯誤發生頻率和類型
- 用戶退出點分析
- 重複訪問模式

#### 技術監控
- 前端性能監控
- API 響應時間監控
- 錯誤率和崩潰監控
- 移動端兼容性監控

---

## 🚀 實施計劃

### 階段一: 核心問題修復 (4 週)

#### 週 1-2: 移除自動跳轉
- [ ] 移除所有 setTimeout 調用
- [ ] 添加繼續按鈕組件
- [ ] 實施按鈕狀態管理
- [ ] 更新導航邏輯

#### 週 3-4: 統一交互模式
- [ ] 標準化按鈕設計
- [ ] 實施鍵盤導航
- [ ] 統一視覺反饋
- [ ] 錯誤處理機制

### 階段二: 用戶體驗增強 (3 週)

#### 週 5-6: 表單驗證優化
- [ ] 實施即時驗證
- [ ] 錯誤消息優化
- [ ] 數據自動保存
- [ ] 錯誤恢復機制

#### 週 7: 認證流程重構
- [ ] 認證延遲策略
- [ ] **封裝現有 Login/Register Form 為組件 (重用現有代碼)**
- [ ] **集成 `better-auth` (禁止新造輪子)**
- [ ] **替換 MagicLinkModal 為 AuthModal**
- [ ] 認證流程集成
- [ ] 測試認證流程

#### 週 8: Phase 2 - LINE & User Features
- [ ] **LINE Notification Service**: 實作 LINE Messaging API 集成
- [ ] **User API**: 實作 `GET /my` 和 `PATCH /cancel`
- [ ] **User UI**: 實作「我的預約」頁面

### 階段三: 響應式設計 (2 週)

#### 週 8-9: 移動端優化
- [ ] 移動優先 CSS 重構
- [ ] 觸控目標優化
- [ ] 字體大小調整
- [ ] 佈局適配測試

### 階段四: 測試與優化 (2 週)

#### 週 10-11: 全面測試
- [ ] 用戶測試
- [ ] 無障礙性測試
- [ ] 性能測試
- [ ] 兼容性測試

---

## 💰 資源評估

### 人力資源

#### 開發團隊
- **前端開發工程師**: 2 人 × 8 週
- **UI/UX 設計師**: 1 人 × 6 週
- **產品經理**: 1 人 × 4 週
- **測試工程師**: 1 人 × 4 週

#### 外部資源
- **用戶測試參與者**: 10-15 人
- **無障礙性顧問**: 1 人 × 2 週
- **性能優化顧問**: 1 人 × 1 週

### 技術資源

#### 基礎設施
- **開發環境**: 現有開發環境
- **測試環境**: 需要配置測試環境
- **監控工具**: 性能和用戶體驗監控
- **分析工具**: 用戶行為分析工具

#### 第三方服務
- **A/B 測試平台**: 可選，用於功能驗證
- **用戶測試平台**: 用於可用性測試
- **無障礙性測試工具**: 自動化無障礙性檢測

---

## 🧪 測試策略

### 功能測試

#### 單元測試
- 組件渲染測試
- 狀態管理測試
- 表單驗證測試
- 錯誤處理測試

#### 集成測試
- 步驟間導航測試
- 數據持久化測試
- API 集成測試
- 認證流程測試

### 用戶測試

#### 可用性測試
- 任務完成率測試
- 用戶滿意度調研
- 錯誤恢復測試
- 學習曲線評估

#### A/B 測試
- 舊版本 vs 新版本對比
- 不同設計方案比較
- 轉換率提升驗證
- 用戶行為差異分析

### 無障礙性測試

#### 自動化測試
- axe-core 無障礙性檢測
- WAVE 工具檢測
- Lighthouse 無障礙性審計
- 鍵盤導航測試

#### 人工測試
- 屏幕閱讀器測試
- 視覺障礙用戶測試
- 認知障礙用戶測試
- 實際用戶使用測試

---

## 📋 風險評估

### 高風險項目

#### R-001: 用戶習慣改變阻力
**風險描述**: 用戶可能抗拒新的交互方式  
**影響程度**: 高  
**緩解措施**:
- 詳細的變更說明
- 用戶教育和引導
- 漸進式部署策略
- 用戶反饋收集機制

#### R-002: 技術實施複雜度
**風險描述**: 重構涉及多個系統組件  
**影響程度**: 高  
**緩解措施**:
- 詳細的技術規劃
- 分階段實施策略
- 充足的測試時間
- 風險預案準備

### 中風險項目

#### R-003: 性能影響
**風險描述**: 新功能可能影響頁面性能  
**影響程度**: 中  
**緩解措施**:
- 性能基準測試
- 性能監控實施
- 優化措施預備
- 漸進式功能啟用

#### R-004: 瀏覽器兼容性
**風險描述**: 舊版瀏覽器可能不支持新功能  
**影響程度**: 中  
**緩解措施**:
- 兼容性測試計劃
- Polyfill 準備
- 降級方案設計
- 瀏覽器使用統計分析

---

## 📞 聯絡信息

### 項目團隊
- **產品經理**: [姓名] - [email]
- **UX 設計師**: [姓名] - [email]
- **前端開發**: [姓名] - [email]
- **測試工程師**: [姓名] - [email]

### 利益相關者
- **業務負責人**: [姓名] - [email]
- **技術負責人**: [姓名] - [email]
- **用戶代表**: [姓名] - [email]

---

## 📚 附錄

### A. 用戶調研結果
*(將附上詳細的用戶調研報告)*

### B. 競品分析
*(將附上競品功能對比分析)*

### C. 技術架構圖
*(將附上系統架構和組件關係圖)*

### D. 原型設計稿
*(將附上詳細的設計稿和原型)*

---

**文檔結束**