{
  "id": "snapshot_1761813095508_g7rd7tgml",
  "approvalId": "approval_1761813095497_s7ilecfg1",
  "approvalTitle": "Black Living Project Structure Documentation",
  "version": 1,
  "timestamp": "2025-10-30T08:31:35.508Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Black Living Project Structure\n\n## Directory Organization\n\nBlack Living follows a **Turborepo-managed monorepo architecture** with clear separation of applications and shared packages:\n\n```\nwebsite-blackliving-ecomm/\n├── .bmad-core/              # BMad method configuration and tooling\n│   ├── agents/             # Specialized AI agent definitions\n│   ├── checklists/         # QA and development checklists\n│   ├── core-config.yaml    # BMad method configuration\n│   ├── data/               # Knowledge base and reference data\n│   ├── tasks/              # Executable workflow definitions\n│   └── templates/          # Document and code templates\n├── .spec-workflow/          # Specification workflow system\n│   ├── steering/           # Steering documents (this file)\n│   ├── templates/          # Specification templates\n│   └── approvals/          # Document approval system\n├── apps/                    # Application packages\n│   ├── admin/              # React-based administrative dashboard\n│   │   ├── app/            # React Router application structure\n│   │   ├── components/     # Admin-specific UI components\n│   │   ├── functions/      # Cloudflare Pages Functions\n│   │   └── public/         # Static assets\n│   ├── api/                # Cloudflare Workers API backend\n│   │   ├── src/            # API source code (Hono routes)\n│   │   └── middleware/     # Authentication and other middleware\n│   └── web/                # Astro-based customer-facing website\n│       ├── src/            # Astro pages and components\n│       └── public/         # Static assets (images, fonts)\n├── packages/                # Shared code packages\n│   ├── auth/               # Authentication and session management\n│   ├── cloudflare-adapter/ # Cloudflare service adapters\n│   ├── db/                 # Database schema and migrations (Drizzle ORM)\n│   ├── tailwind-config/    # Shared Tailwind CSS configuration\n│   ├── tailwindcss-typography/  # Typography plugin extension\n│   ├── types/              # Shared TypeScript type definitions\n│   └── ui/                 # Reusable UI component library (Shadcn)\n├── docs/                   # Project documentation\n│   ├── api-documentation.md # API endpoint documentation\n│   ├── architecture/       # Architecture decision records\n│   └── qa/                 # Quality assurance documentation\n├── research/               # Business analysis and requirements research\n├── scripts/                # Development and deployment scripts\n├── deployment/             # Deployment configuration and tooling\n├── public/                 # Shared static assets\n└── config files            # Project configuration (*.config.*, *.json)\n```\n\n## Monorepo Organization Principles\n\n### Application Packages (`apps/`)\n\nEach application is a **self-contained deployable unit** with minimal cross-dependencies:\n\n- **`web`**: Customer-facing e-commerce platform (Astro + React)\n- **`admin`**: Administrative dashboard for content management (React + React Router)\n- **`api`**: Serverless backend API (Cloudflare Workers + Hono)\n\n**Isolation Rules:**\n- Applications can depend on packages but not on other applications\n- Each application has its own build configuration and deployment pipeline\n- Cross-application communication only through public APIs\n\n### Shared Packages (`packages/`)\n\nPackages provide reusable functionality across applications:\n\n- **`auth`**: Centralized authentication logic using Better Auth\n- **`db`**: Database schema, migrations, and query utilities\n- **`ui`**: Design system components built with Shadcn UI\n- **`types`**: TypeScript interfaces shared across applications\n- **`cloudflare-adapter`**: Abstractions for Cloudflare services (KV, R2, D1)\n\n**Package Rules:**\n- Packages can depend on other packages but not on applications\n- Must be platform-agnostic and framework-independent where possible\n- Versioned independently with semantic versioning\n\n## Naming Conventions\n\n### Files and Directories\n\n**General Rules:**\n- **Directories**: `kebab-case` (e.g., `user-management`, `order-processing`)\n- **React Components**: `PascalCase.jsx` or `PascalCase.tsx`\n- **TypeScript Types**: `PascalCase.ts`\n- **Utility Functions**: `camelCase.ts`\n- **Configuration Files**: `kebab-case.config.js` or `kebab-case.config.ts`\n- **Test Files**: `[filename].test.ts` or `[filename].spec.ts`\n\n**Application-Specific:**\n```\napps/admin/\n├── components/              # kebab-case directories\n│   ├── user-list/\n│   └── order-modal/\n└── routes/                  # Feature-based organization\n    ├── dashboard/\n    ├── products/\n    └── orders/\n\napps/api/\n├── modules/                 # Domain-driven organization\n│   ├── auth/\n│   ├── products/\n│   └── orders/\n└── routes/                  # RESTful route organization\n    ├── v1/\n    └── health/\n```\n\n### Code Naming\n\n**TypeScript/JavaScript:**\n```\nVariables/Functions:     camelCase\nClasses/Types:           PascalCase\nConstants:               SCREAMING_SNAKE_CASE\nEnums:                   PascalCase\nInterfaces:              PascalCase (prefixed with 'I' optional)\nDatabase Tables:         snake_case\nDatabase Columns:        snake_case\nAPI Endpoints:           kebab-case\nCSS Classes:             kebab-case\nFile Names:              kebab-case for utilities, PascalCase for components\n```\n\n**Examples:**\n```typescript\n// Variables and functions\nconst userName = 'john';\nfunction getUserById(id: string) { ... }\n\n// Types and interfaces\ninterface UserProfile { ... }\ntype OrderStatus = 'pending' | 'completed';\n\n// Constants\nconst MAX_RETRY_COUNT = 3;\nconst API_BASE_URL = '/api/v1';\n\n// Database schema (from packages/db/schema.ts)\nexport const users = table('users', {\n  id: text('id').primaryKey(),\n  email: text('email').notNull().unique(),\n  createdAt: integer('created_at', { mode: 'timestamp' }),\n});\n```\n\n## Import Patterns\n\n### Import Order (within files)\n\n1. **External Dependencies** (npm packages)\n2. **Internal Packages** (`@blackliving/*`)\n3. **Relative Imports** (`./`, `../`)\n4. **Type Imports** (TypeScript `import type`)\n5. **CSS/SCSS Imports** (at end)\n\n**Example File Structure:**\n```typescript\n// 1. External dependencies\nimport { useState } from 'react';\nimport { z } from 'zod';\n\n// 2. Internal packages\nimport { Button } from '@blackliving/ui';\nimport { createUser } from '@blackliving/auth';\n\n// 3. Relative imports\nimport { formatUser } from './utils';\nimport { UserForm } from '../components/UserForm';\n\n// 4. Type imports\nimport type { User, Order } from '../../../types';\n\n// 5. Styles (if needed)\nimport './UserList.css';\n```\n\n### Module Resolution (`tsconfig.json`)\n\nAll projects use **path mapping** for clean imports:\n\n```json\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@/*\": [\"./src/*\"],                    // Within packages\n      \"@blackliving/*\": [\"../../packages/*\"] // Cross-package imports\n    }\n  }\n}\n```\n\n### Barrel Exports\n\nPackages use **index files** for clean public APIs:\n\n```typescript\n// packages/ui/index.ts - Barrel export\nexport { Button } from './components/Button';\nexport { Input } from './components/Input';\nexport { Card } from './components/Card';\n\n// Usage in apps\nimport { Button, Input, Card } from '@blackliving/ui';\n```\n\n## Code Structure Patterns\n\n### React Component Organization (`apps/`)\n\n**File Structure per Component:**\n```\nComponentName/\n├── ComponentName.tsx        # Main component\n├── ComponentName.test.tsx   # Unit tests\n├── index.ts                 # Barrel export\n└── types.ts                 # Component-specific types\n```\n\n**Component File Organization:**\n```tsx\n// ComponentName.tsx\nimport { useState } from 'react';\nimport type { ComponentProps } from './types';\n\n// Types (at top)\ninterface Props {\n  user: User;\n  onUpdate: (user: User) => void;\n}\n\n// Constants\nconst DEFAULT_AVATAR = '/default-avatar.png';\n\n// Main component\nexport function UserProfile({ user, onUpdate }: Props) {\n  const [isEditing, setIsEditing] = useState(false);\n\n  // Event handlers\n  const handleSave = () => {\n    onUpdate(user);\n    setIsEditing(false);\n  };\n\n  // Render\n  return (\n    <div className=\"user-profile\">\n      {/* Component JSX */}\n    </div>\n  );\n}\n```\n\n### API Route Organization (`apps/api/`)\n\n**Hono Route Structure:**\n```typescript\n// routes/users.ts\nimport { Hono } from 'hono';\nimport { getUsers, createUser } from '../modules/users';\n\nconst app = new Hono();\n\n// GET /api/users\napp.get('/', async (c) => {\n  const users = await getUsers();\n  return c.json({ users });\n});\n\n// POST /api/users\napp.post('/', async (c) => {\n  const body = await c.req.json();\n  const user = await createUser(body);\n  return c.json({ user }, 201);\n});\n\nexport default app;\n```\n\n### Database Module Organization (`packages/db/`)\n\n**Drizzle ORM Structure:**\n```typescript\n// schema.ts\nimport { sqliteTable, text, integer } from 'drizzle-orm/sqlite-core';\n\nexport const users = sqliteTable('users', {\n  id: text('id').primaryKey(),\n  email: text('email').notNull().unique(),\n  name: text('name'),\n  createdAt: integer('created_at', { mode: 'timestamp' }).notNull(),\n});\n\n// queries.ts\nimport { eq } from 'drizzle-orm';\nimport { db } from './client';\n\nexport async function getUserById(id: string) {\n  return db.select().from(users).where(eq(users.id, id)).limit(1);\n}\n\nexport async function createUser(data: { email: string; name?: string }) {\n  return db.insert(users).values(data).returning();\n}\n```\n\n## Code Organization Principles\n\n### 1. Single Responsibility Principle\n- Each file has one clear, focused responsibility\n- Functions handle one operation or calculation\n- Components render one piece of UI or handle one interaction pattern\n\n### 2. Feature-Based Organization\n- Code organized by business domain/feature rather than technical layer\n- Related components, logic, and types stay together\n- Clear boundaries between different features\n\n### 3. Dependency Direction\n- **apps** → **packages** (applications depend on shared packages)\n- **packages** → **packages** (can depend on other packages)\n- **apps** ↛ **apps** (applications cannot depend on each other)\n\n### 4. DRY (Don't Repeat Yourself)\n- Shared logic abstracted into utility functions or packages\n- Common UI patterns become reusable components\n- Database queries and business logic centralized\n\n### 5. Testability First\n- Functions designed to be easily unit tested\n- Components structured for meaningful integration tests\n- Clear separation of concerns enables focused testing\n\n## Module Boundaries\n\n### Internal vs External APIs\n\n**Internal APIs** (within applications):\n- Can use direct imports and internal data structures\n- Loose coupling within feature boundaries\n- Application-specific optimizations allowed\n\n**External APIs** (between applications/packages):\n- RESTful HTTP APIs for inter-application communication\n- Public TypeScript APIs with clear contracts\n- Versioned interfaces with backward compatibility\n\n### Business Domain Separation\n\n**Domain Examples:**\n- `auth`: User authentication and session management\n- `products`: Product catalog and inventory management\n- `orders`: Order processing and fulfillment\n- `content`: Blog posts, CMS, and static content\n\n**Domain Rules:**\n- Each domain has clear ownership and responsibility\n- Domains communicate through APIs, not direct database access\n- Shared types defined in `packages/types`\n\n## Code Size Guidelines\n\n### File Size Limits\n- **Component files**: < 300 lines\n- **Utility files**: < 200 lines\n- **API route files**: < 150 lines\n- **Type definition files**: < 100 lines\n\n### Function Size Limits\n- **Component functions**: < 50 lines\n- **Utility functions**: < 30 lines\n- **API handlers**: < 40 lines\n\n### Complexity Limits\n- **Cyclomatic complexity**: < 10 per function\n- **Nesting depth**: < 4 levels per function\n- **Parameters per function**: < 5 parameters\n\n## Documentation Standards\n\n### Code Comments\n- Complex business logic requires explanation comments\n- Public APIs must have JSDoc comments\n- TODO comments include issue references\n- Deprecation notices for phased-out code\n\n### Documentation Files\n- README.md files required for all packages\n- Architecture decisions documented as ADRs\n- API endpoints documented with OpenAPI spec\n- Component usage documented with examples\n\n## Development Workflow Integration\n\n### Turbo Build System\n- Build tasks declared in `turbo.json`\n- Caching enabled for unchanged packages\n- Parallel execution of independent tasks\n\n### Testing Structure\n```\n├── apps/*/src/**/__tests__/     # Unit and integration tests\n├── packages/*/src/**/__tests__/  # Package unit tests\n└── apps/*/e2e/                   # End-to-end tests\n```\n\n### Configuration Management\n**Environment-Based Config:**\n- `.env` files for development environment variables\n- Wrangler secrets for production environment variables\n- Configuration\n",
  "fileStats": {
    "size": 13214,
    "lines": 417,
    "lastModified": "2025-10-30T08:31:25.689Z"
  },
  "comments": []
}