{
  "id": "snapshot_1761811126945_z70ko7sbo",
  "approvalId": "approval_1761811126923_dhu4u5j6f",
  "approvalTitle": "Tech.md - Black Living Technology Stack Documentation",
  "version": 1,
  "timestamp": "2025-10-30T07:58:46.944Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Black Living Technology Stack\n\n## Project Type\nBlack Living is a full-stack, cloud-native e-commerce platform consisting of:\n- **Customer-facing website** (Astro.js React application)\n- **Administrative dashboard** (React SPA)\n- **REST API backend** (Cloudflare Workers)\n- **Shared component library** (TypeScript/React)\n- **Monorepo architecture** with shared tooling and utilities\n\n## Core Technologies\n\n### Primary Language(s)\n- **TypeScript 5.x**: Primary language for all applications, ensuring type safety across frontend, backend, and shared packages\n- **Runtime**: Node.js 18+ for development, Cloudflare Workers runtime for API deployment\n- **Package Management**: pnpm for efficient workspace management and dependency resolution\n\n### Key Dependencies/Libraries\n\n#### Frontend Framework\n- **Astro 3.x**: Static site generation and server-side rendering for the main website\n- **React 18.x**: Component-based UI development for interactive features\n- **Vite 4.x**: Fast development server and build tool for admin dashboard\n\n#### Database & Storage\n- **Drizzle ORM**: Type-safe SQL query builder for database operations\n- **Cloudflare D1**: SQLite-compatible database for data persistence\n- **Cloudflare KV**: Key-value storage for session management and caching\n\n#### UI & Styling\n- **Tailwind CSS**: Utility-first CSS framework for consistent styling\n- **Radix UI**: Accessible component primitives for admin interface\n- **Headless UI**: Unstyled UI components for custom implementations\n\n#### Development Tools\n- **Turborepo**: High-performance build system for monorepo orchestration\n- **Biome**: Fast linter and code formatter for code quality\n- **Vitest**: Modern testing framework with TypeScript support\n\n### Application Architecture\nBlack Living follows a **modular monorepo architecture** with clear separation of concerns:\n\n- **apps/web**: Customer-facing e-commerce site (Astro.js SSR/SSG)\n- **apps/admin**: Administrative dashboard (React SPA)\n- **apps/api**: Serverless API layer (Cloudflare Workers)\n- **packages/**: Shared utilities and components\n\n**Architecture Patterns**:\n- **Atomic Design**: UI components organized by complexity (atoms → molecules → organisms)\n- **Feature-based organization**: Code organized around business domains\n- **Dependency injection**: Shared services injected at appropriate layers\n\n### Data Storage\n- **Primary storage**: Cloudflare D1 (SQLite-compatible distributed database)\n- **Document storage**: MongoDB-style schemas with Drizzle ORM\n- **Session storage**: Cloudflare KV for user sessions and temporary data\n- **File storage**: Cloudflare R2 for product images and assets\n- **Caching**: Cloudflare KV for frequently accessed data\n\n### External Integrations\n- **Payment Processing**: Taiwan payment gateways (future integration)\n- **Email Service**: Transactional email delivery\n- **Analytics**: Web analytics and conversion tracking\n- **Content Delivery**: Cloudflare CDN for global asset distribution\n- **Authentication**: OAuth 2.0 compatible providers\n\n### Monitoring & Dashboard Technologies\n- **Admin Dashboard**: React-based administrative interface\n- **Real-time Monitoring**: WebSocket connections for live updates\n- **Performance Monitoring**: Cloudflare Web Analytics\n- **Error Tracking**: Centralized logging and alerting\n- **Analytics**: User behavior tracking and business metrics\n\n## Development Environment\n\n### Build & Development Tools\n- **Build System**: Turborepo with custom pipelines for each application\n- **Package Management**: pnpm workspace with strict dependency resolution\n- **Development Servers**: Vite (admin), Astro dev server (web)\n- **Hot Reload**: Enabled across all development environments\n\n### Code Quality Tools\n- **Static Analysis**: TypeScript strict mode with custom ESLint rules\n- **Formatting**: Biome for consistent code formatting\n- **Testing Framework**: Vitest for unit tests, Playwright for E2E testing\n- **Type Checking**: TypeScript with strict null checks and no implicit any\n- **Documentation**: MDX for component documentation\n\n### Version Control & Collaboration\n- **VCS**: Git with GitHub for source control\n- **Branching Strategy**: GitHub Flow (main branch, feature branches)\n- **Code Review Process**: Pull request reviews with required approvals\n- **CI/CD**: GitHub Actions for automated testing and deployment\n\n### Dashboard Development\n- **Live Reload**: Hot module replacement for instant UI updates\n- **Port Management**: Configurable development ports (3000, 4000, etc.)\n- **Multi-Instance Support**: Concurrent development servers for different apps\n\n## Deployment & Distribution\n- **Target Platform(s)**: Cloudflare Pages (frontend), Cloudflare Pages Functions (API)\n- **Distribution Method**: SaaS platform accessible via web browsers\n- **Global CDN**: Cloudflare's worldwide network for low-latency delivery\n- **Installation Requirements**: Modern web browser (no client installation)\n\n## Technical Requirements & Constraints\n\n### Performance Requirements\n- **Page Load Time**: <2 seconds average across all pages\n- **API Response Time**: <500ms for 95th percentile requests\n- **Mobile Performance**: Core Web Vitals scores >90\n- **Scalability**: Handle 10,000+ concurrent users\n\n### Compatibility Requirements\n- **Browser Support**: Modern evergreen browsers (Chrome, Firefox, Safari, Edge)\n- **Device Support**: Mobile-first responsive design\n- **API Compatibility**: RESTful APIs with OpenAPI specification\n- **Platform Independence**: Works on desktop and mobile platforms\n\n### Security & Compliance\n- **Authentication**: Secure user authentication with proper session management\n- **Data Protection**: PCI DSS compliance for payment data handling\n- **GDPR Compliance**: User data protection and privacy controls\n- **Security Headers**: Comprehensive security headers and CSP policies\n\n### Scalability & Reliability\n- **Global Distribution**: CDN-backed architecture for worldwide performance\n- **Fault Tolerance**: Graceful degradation and comprehensive error handling\n- **Database Scalability**: Cloudflare D1's distributed architecture\n- **99.9% Uptime Target**: High availability through Cloudflare's infrastructure\n\n## Technical Decisions & Rationale\n\n### Decision Log\n1. **Astro.js for Main Website**: Chosen for superior SEO, performance, and developer experience. Islands architecture allows selective hydration while maintaining fast loading times. Considered Next.js but Astro provides better static generation for content-heavy e-commerce pages.\n\n2. **Cloudflare Platform**: Single-vendor solution for compute, database, storage, and CDN reduces complexity and operational overhead. D1 provides SQLite-compatible database with global replication. Considered Vercel + PlanetScale but lacked data sovereignty requirements.\n\n3. **Drizzle ORM**: Type-safe SQL builder ensuring compile-time query validation. Schema-first approach aligns with TypeScript-first development philosophy. Considered Prisma but Drizzle's lightweight bundle size is better for edge runtime deployment.\n\n4. **Monorepo with Turborepo**: Centralizes shared code and tooling while maintaining independent deployment. pnpm workspaces provide efficient package management. Enables atomic changes across multiple applications while maintaining deployment isolation.\n\n5. **Tailwind CSS**: Utility-first approach enables rapid UI development and consistent design system. Small bundle size and zero runtime performance impact. Considered CSS-in-JS but Tailwind provides better maintainability and performance.\n\n## Known Limitations\n\n### Current Limitations\n1. **Single Database Solution**: Currently limited to Cloudflare D1 which, while globally distributed, may have scaling limits for extremely high-volume e-commerce workloads. Potential future migration to dedicated database solutions if needed.\n\n2. **Edge Runtime Constraints**: Cloudflare Workers runtime limitations affect certain NPM package compatibility. Workarounds required for packages not supporting ESM or having Node.js-specific dependencies.\n\n3. **Geographic Data Residency**: Cloudflare's data centers are primarily US/EU-focused, which may have implications for specific data residency requirements in different jurisdictions.\n\n4. **Development Tooling**: Some advanced developer tools have limited support in the edge runtime environment, requiring custom solutions or workarounds.\n\n### Planned Improvements\n1. **Hybrid Architecture**: Gradual migration to hybrid serverless-traditional architecture for complex business logic\n2. **Multi-Region Support**: Enhanced geographic data distribution and residency controls\n3. **Advanced Analytics**: Implementation of real-time analytics and machine learning capabilities\n4. **Progressive Web App**: Enhanced offline capabilities and native app-like experiences\n",
  "fileStats": {
    "size": 8796,
    "lines": 161,
    "lastModified": "2025-10-30T07:58:40.185Z"
  },
  "comments": []
}